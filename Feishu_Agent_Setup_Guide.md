# 飞书多智能体配置操作指南 🚀

为了让我们的 4 个 Agent 实物化，我们需要在飞书开放平台为它们创建 4 个独立的机器人“身份证”。

## 第一步：创建团队应用（重复 4 次）

请登录 [飞书开发者后台 (open.feishu.cn)](https://open.feishu.cn/app/)。针对以下每个角色，点击“创建企业自建应用”，填写名称和图标：

1. 👑 **大管家-马云** —— 负责大局与任务拆解
2. 🔍 **百晓生-张一鸣** —— 负责查资料与挖灵感
3. 💻 **代码极客-Linus** —— 负责撸代码和做验证
4. ✍️ **笔杆子-吴晓波** —— 负责文案提炼与写推文

创建完第一个应用（如 大管家-马云）后，进入应用详情页，完成以下通用配置：

## 第二步：获取核心凭证 (App ID & Secret)

在应用的 **[凭证与基础信息]** 页面：
* 找到 `App ID` (通常以 `cli_` 开头)
* 找到 `App Secret`
👉 **【操作记录】**：把这两个值复制下来。由于插件设计机制，四个应用可以共享一套 `App ID` 和 `Secret`（如果使用主应用的配置），但最外层的飞书插件配置必须用**其中一个主应用（比如 大管家-马云）**的作为基础连接通道。

## 第三步：开通机器人能力

在左侧导航栏找到 **[添加应用能力] -> [机器人]**：
* 点击 `添加`
* 只有添加了机器人能力，它才能被拉入我们的办公群聊。

## 第四步：订阅长连接与事件 (极其重要 ⚠️)

因为我们采用 WebSocket 长连接模式（无需公网 IP），所以在左侧导航栏找到 **[事件与回调]**：

1. **配置通讯方式**：不要填 Webhook URL！选择 **[使用长连接接收事件]**（WebSocket 模式）并保存。
2. **添加事件订阅**：点击“添加事件”，搜索并勾选以下四个必备事件：
   * `im.message.receive_v1` (接收消息)
   * `im.message.message_read_v1` (消息已读回执)
   * `im.chat.member.bot.added_v1` (机器人进群自动响应)
   * `im.chat.member.bot.deleted_v1` (机器人被移除)

## 第五步：开启 API 权限

在左侧导航栏找到 **[权限管理]**，搜索并在“未申请”列表里勾选开通以下核心权限：
* `im:message:send_as_bot` (以机器人身份发送消息)
* `im:message` (获取单聊、群聊消息)
* `im:resource` (获取与上传图片/文件媒体资源)
* `bitable:app` (多维表格读写权限，**为了实现我们的 Kanban 看板！**)
* `bitable:app:readonly` (多维表格只读)

## 第六步：获取独立 Bot ID 进行路由绑定

为实现多 Agent 路由，OpenClaw 通过 `Bot ID` 区分现在在跟谁说话。
在您的个人飞书客户端：
1. 搜索并找到您刚创建的机器人（例如：大管家-马云）。
2. 在资料卡里，或者通过接口调试工具，找到它的 `User ID`（Bot 本身在飞书里的唯一标识）。
👉 **【操作记录】**：把各个机器人的 `Bot ID` 记录下来。如果在飞书界面上找不到，也可以等配好 `App ID` 后运行 OpenClaw，通过后台日志查看到被呼叫的 `Bot ID`。

## 第七步：发布版本

在左侧导航栏找到 **[版本管理与发布]**：
* 点击“创建版本”，随便填入版本号和更新说明。
* 在“可用范围”里，选择您自己所在的部门或群组。
* 点击“申请发布”（如果是管理员会直接发布通过）。

---

### 把配置交给 OpenClaw

当您完成以上配置并拿到了 `App ID`, `App Secret` 以及这四个机器人的 `Bot ID` 后，您的工作就完成了！请把它们提供给我，我会帮您将临时文件 `/Users/mudandan/.openclaw/openclaw.json` 中的 `TODO` 占位符修改为真实值！
